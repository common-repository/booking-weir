!function(){var e={95318:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},2459:function(e,t,r){"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(65736),a=n(r(69887)),s=n(r(71377)),i=n(r(26016)),l=n(r(18887)),c=n(r(15865)),d=n(r(11139)),u=n(r(25637)),p=n(r(32774)),f=r(85028);const h={Accept:"application/json, */*;q=0.1"},w={credentials:"include"},v=[u.default,c.default,d.default,l.default],_=e=>{if(e.status>=200&&e.status<300)return e;throw e};let m=e=>{const{url:t,path:r,data:n,parse:a=!0,...s}=e;let{body:i,headers:l}=e;return l={...h,...l},n&&(i=JSON.stringify(n),l["Content-Type"]="application/json"),window.fetch(t||r||window.location.href,{...w,...s,body:i,headers:l}).then(e=>Promise.resolve(e).then(_).catch(e=>(0,f.parseAndThrowError)(e,a)).then(e=>(0,f.parseResponseAndNormalizeError)(e,a)),e=>{if(e&&"AbortError"===e.name)throw e;throw{code:"fetch_error",message:(0,o.__)("You are probably offline.")}})};function g(e){return v.reduceRight((e,t)=>r=>t(r,e),m)(e).catch(t=>"rest_cookie_invalid_nonce"!==t.code?Promise.reject(t):window.fetch(g.nonceEndpoint).then(_).then(e=>e.text()).then(t=>(g.nonceMiddleware.nonce=t,g(e))))}g.use=function(e){v.unshift(e)},g.setFetchHandler=function(e){m=e},g.createNonceMiddleware=a.default,g.createPreloadingMiddleware=i.default,g.createRootURLMiddleware=s.default,g.fetchAllMiddleware=l.default,g.mediaUploadMiddleware=p.default;var y=g;t.default=y},18887:function(e,t,r){"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(96483),a=n(r(2459));const s=(e,t)=>{let{path:r,url:n,...a}=e;return{...a,url:n&&(0,o.addQueryArgs)(n,t),path:r&&(0,o.addQueryArgs)(r,t)}},i=e=>e.json?e.json():Promise.reject(e),l=e=>{const{next:t}=(e=>{if(!e)return{};const t=e.match(/<([^>]+)>; rel="next"/);return t?{next:t[1]}:{}})(e.headers.get("link"));return t};t.default=async(e,t)=>{if(!1===e.parse)return t(e);if(!(e=>{const t=!!e.path&&-1!==e.path.indexOf("per_page=-1"),r=!!e.url&&-1!==e.url.indexOf("per_page=-1");return t||r})(e))return t(e);const r=await(0,a.default)({...s(e,{per_page:100}),parse:!1}),n=await i(r);if(!Array.isArray(n))return n;let o=l(r);if(!o)return n;let c=[].concat(n);for(;o;){const t=await(0,a.default)({...e,path:void 0,url:o,parse:!1}),r=await i(t);c=c.concat(r),o=l(t)}return c}},11139:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const r=new Set(["PATCH","PUT","DELETE"]),n="GET";t.default=(e,t)=>{const{method:o=n}=e;return r.has(o.toUpperCase())&&(e={...e,headers:{...e.headers,"X-HTTP-Method-Override":o,"Content-Type":"application/json"},method:"POST"}),t(e)}},32774:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(65736),o=r(85028);t.default=(e,t)=>{if(!function(e){const t=!!e.method&&"POST"===e.method;return(!!e.path&&-1!==e.path.indexOf("/wp/v2/media")||!!e.url&&-1!==e.url.indexOf("/wp/v2/media"))&&t}(e))return t(e);let r=0;const a=e=>(r++,t({path:`/wp/v2/media/${e}/post-process`,method:"POST",data:{action:"create-image-subsizes"},parse:!1}).catch(()=>r<5?a(e):(t({path:`/wp/v2/media/${e}?force=true`,method:"DELETE"}),Promise.reject())));return t({...e,parse:!1}).catch(t=>{const r=t.headers.get("x-wp-upload-attachment-id");return t.status>=500&&t.status<600&&r?a(r).catch(()=>!1!==e.parse?Promise.reject({code:"post_process",message:(0,n.__)("Media upload failed. If this is a photo or a large image, please scale it down and try again.")}):Promise.reject(t)):(0,o.parseAndThrowError)(t,e.parse)}).then(t=>(0,o.parseResponseAndNormalizeError)(t,e.parse))}},15865:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=(e,t)=>{let r,n,o=e.path;return"string"==typeof e.namespace&&"string"==typeof e.endpoint&&(r=e.namespace.replace(/^\/|\/$/g,""),n=e.endpoint.replace(/^\//,""),o=n?r+"/"+n:r),delete e.namespace,delete e.endpoint,t({...e,path:o})}},69887:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){const t=(e,r)=>{const{headers:n={}}=e;for(const o in n)if("x-wp-nonce"===o.toLowerCase()&&n[o]===t.nonce)return r(e);return r({...e,headers:{...n,"X-WP-Nonce":t.nonce}})};return t.nonce=e,t}},26016:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(96483);function o(e,t){return Promise.resolve(t?e.body:new window.Response(JSON.stringify(e.body),{status:200,statusText:"OK",headers:e.headers}))}t.default=function(e){const t=Object.keys(e).reduce((t,r)=>(t[(0,n.normalizePath)(r)]=e[r],t),{});return(e,r)=>{const{parse:a=!0}=e;let s=e.path;if(!s&&e.url){const t=(0,n.getQueryArg)(e.url,"rest_route");"string"==typeof t&&(s=t)}if("string"!=typeof s)return r(e);const i=e.method||"GET",l=(0,n.normalizePath)(s);if("GET"===i&&t[l]){const e=t[l];return delete t[l],o(e,!!a)}if("OPTIONS"===i&&t[i]&&t[i][l]){const e=t[i][l];return delete t[i][l],o(e,!!a)}return r(e)}}},71377:function(e,t,r){"use strict";var n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(15865));t.default=e=>(t,r)=>(0,o.default)(t,t=>{let n,o=t.url,a=t.path;return"string"==typeof a&&(n=e,-1!==e.indexOf("?")&&(a=a.replace("?","&")),a=a.replace(/^\//,""),"string"==typeof n&&-1!==n.indexOf("?")&&(a=a.replace("?","&")),o=n+a),r({...t,url:o})})},25637:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(96483);t.default=(e,t)=>("string"!=typeof e.url||(0,n.hasQueryArg)(e.url,"_locale")||(e.url=(0,n.addQueryArgs)(e.url,{_locale:"user"})),"string"!=typeof e.path||(0,n.hasQueryArg)(e.path,"_locale")||(e.path=(0,n.addQueryArgs)(e.path,{_locale:"user"})),t(e))},85028:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseAndThrowError=s,t.parseResponseAndNormalizeError=void 0;var n=r(65736);const o=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?204===e.status?null:e.json?e.json():Promise.reject(e):e},a=e=>{const t={code:"invalid_json",message:(0,n.__)("The response is not a valid JSON response.")};if(!e||!e.json)throw t;return e.json().catch(()=>{throw t})};function s(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t)throw e;return a(e).then(e=>{const t={code:"unknown_error",message:(0,n.__)("An unknown error occurred.")};throw e||t})}t.parseResponseAndNormalizeError=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Promise.resolve(o(e,t)).catch(e=>s(e,t))}},65736:function(e){"use strict";e.exports=window.wp.i18n},96483:function(e){"use strict";e.exports=window.wp.url}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}!function(){"use strict";window.wp.hooks;var e=r(65736),t=window.wp.blocks,n=window.wp.blockEditor,o=window.wp.compose,a=window.wp.components,s=window.wp.element,i=function(e){let{icon:t,size:r=24,...n}=e;return(0,s.cloneElement)(t,{width:r,height:r,...n})},l=window.wp.primitives,c=(0,s.createElement)(l.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)(l.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm.5 16c0 .3-.2.5-.5.5H5c-.3 0-.5-.2-.5-.5V7h15v12zM9 10H7v2h2v-2zm0 4H7v2h2v-2zm4-4h-2v2h2v-2zm4 0h-2v2h2v-2zm-4 4h-2v2h2v-2zm4 0h-2v2h2v-2z"})),d=window.React,u=(r(96483),r(2459));const{api_url:p,api_nonce:f,nonce_endpoint:h}=window.booking_weir_data||{};u.default.nonceMiddleware=u.default.createNonceMiddleware(f),h&&(u.default.nonceEndpoint=h),u.default.rootURLMiddleware=u.default.createRootURLMiddleware(p),u.default.use(u.default.nonceMiddleware),u.default.use(u.default.rootURLMiddleware);var w=u.default;const v=booking_weir_data.white_label?(0,e._x)("Booking calendar","White label block title","booking-weir"):(0,e.__)("Booking Weir calendar","booking-weir"),_=[{label:(0,e.__)("Default"),value:"default"},{label:(0,e.__)("Services"),value:"services"}],m=t=>{let{attributes:{calendarId:r,type:s},setAttributes:l}=t;const u=(0,n.useBlockProps)({className:"components-placeholder",style:{alignItems:"center"}}),p="bw-calendar-select-"+(0,o.useInstanceId)(m),[f,h]=(0,d.useState)([]),[g,y]=(0,d.useState)(""),[b,E]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{y(""),async function(){return(e=>e.success?e.value:e.message)(await w({method:"GET",path:"calendars/get"}))}().then(e=>{h(Object.keys(e).map(t=>({label:e[t],value:t})))}).catch(t=>{y((0,e.__)("Failed fetching calendars","booking-weir")+(t.message?": "+t.message:""))})},[b]),React.createElement("div",u,"undefined"!=typeof IS_PREMIUM&&IS_PREMIUM&&React.createElement(n.InspectorControls,null,React.createElement(a.PanelBody,{title:(0,e.__)("Settings","booking-weir")},React.createElement(a.RadioControl,{label:(0,e.__)("Type","booking-weir"),options:_,selected:s,onChange:e=>l({type:e})}))),React.createElement("label",{htmlFor:p,className:"components-placeholder__label"},React.createElement(i,{icon:c}),v),React.createElement(a.SelectControl,{id:p,options:[{label:"-",value:""}].concat(f),value:r,onChange:e=>l({calendarId:e}),style:{width:300}}),g.length>0&&React.createElement(a.Notice,{status:"error",isDismissible:!1,actions:[{label:(0,e.__)("Retry","booking-weir"),onClick:()=>E(!b)}]},g))};(0,t.registerBlockType)("booking-weir/calendar",{apiVersion:2,title:v,description:(0,e.__)("Display a booking calendar.","booking-weir"),category:"booking-weir",icon:c,attributes:{calendarId:{type:"string",default:""},type:{type:"string",default:"default"}},supports:{html:!1,align:["wide","full"],multiple:!1,reusable:!1},edit:m,save:()=>null})}()}();